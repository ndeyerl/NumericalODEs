% ARK test script

%ARK3
c = [0; 1767732205903/2027836641118; 3/5; 1]; 
b = [1471266399579/7840856788654, -4482444167858/7529755066697, ...
  11266239266428/11593286722821, 1767732205903/4055673282236];
AE = [0, 0, 0, 0;...
  1767732205903/2027836641118, 0, 0, 0;...
  5535828885825/10492691773637, 788022342437/10882634858940, 0, 0;...
  6485989280629/16251701735622, -4246266847089/9704473918619, 10755448449292/10357097424841, 0];
gamma = 1767732205903/4055673282236; 
AI = [0, 0, 0, 0; 1767732205903/4055673282236, gamma, 0, 0;...
  2746238789719/10658868560708, -640167445237/6845629431997, gamma, 0;...
  1471266399579/7840856788654, -4482444167858/7529755066697, 11266239266428/11593286722821, gamma];
s = 4;
range = [0, 1];
h = [.1, .01, .001, .0001];
eps = [1, .1, .01, .001, .0001];
fprintf('ARK3\n');
k = 1;
fprintf('problem %d\n',k);
for i=1:length(eps)
    for j=1:length(h)
        [u, utrue, maxerr, t] = ARKERKDIRK(AE, AI, b, c, s, h(j), range, eps(i), k);
        fprintf('h = %e eps = %e maxerr = %e\n',h(j),eps(i),maxerr);
    end
end
eps = -eps;
for k = 2:4
    fprintf('problem %d\n',k);
    for i=1:length(eps)
        for j=1:length(h)
            [u, utrue, maxerr, t] = ARKERKDIRK(AE, AI, b, c, s, h(j), range, eps(i), k);
            fprintf('h = %e eps = %e maxerr = %e\n',h(j),eps(i),maxerr);
        end
    end
end

%ARK4
c = [0; 1/2; 83/250; 31/50; 17/20; 1];
b = [82889/524892, 0, 15625/83664, 69875/102672, -2260/8211, 1/4];
AE = [0, 0, 0, 0, 0, 0;
1/2, 0, 0, 0, 0, 0;
13861/62500, 6889/62500, 0 0 0 0;
-116923316275/2393684061468, -2731218467317/15368042101831, ...
9408046702089/11113171139209, 0, 0, 0;
-451086348788/2902428689909, -2682348792572/7519795681897, ...
12662868775082/11960479115383, 3355817975965/11060851509271, 0, 0;
647845179188/3216320057751, 73281519250/8382639484533, ...
552539513391/3454668386233, 3354512671639/8306763924573, ...
4040/17871, 0];
AI = [0, 0, 0, 0, 0, 0;
1/4, 1/4, 0, 0, 0, 0;
8611/62500, -1743/31250, 1/4, 0, 0, 0;
5012029/34652500, -654441/2922500, 174375/388108, 1/4, 0, 0;
15267082809/155376265600, -71443401/120774400, 730878875/902184768, ...
 2285395/8070912, 1/4, 0;
82889/524892, 0, 15625/83664, 69875/102672, -2260/8211, 1/4];
s = 6;
range = [0, 1];
h = [.1, .01, .001, .0001];
eps = [1, .1, .01, .001, .0001];
fprintf('ARK4\n');
k = 1;
fprintf('problem %d\n',k);
for i=1:length(eps)
    for j=1:length(h)
        [u, utrue, maxerr, t] = ARKERKDIRK(AE, AI, b, c, s, h(j), range, eps(i), k);
        fprintf('h = %e eps = %e maxerr = %e\n',h(j),eps(i),maxerr);
    end
end
eps = -eps;
for k = 2:4
    fprintf('problem %d\n',k);
    for i=1:length(eps)
        for j=1:length(h)
            [u, utrue, maxerr, t] = ARKERKDIRK(AE, AI, b, c, s, h(j), range, eps(i), k);
            fprintf('h = %e eps = %e maxerr = %e\n',h(j),eps(i),maxerr);
        end
    end
end

c = [0; 41/100; 2935347310677/11292855782101; ...
1426016391358/7196633302097; 92/100; 24/100; 3/5; 1];
b = [-872700587467/9133579230613, 0, 0, 22348218063261/9555858737531, ...
-1143369518992/8141816002931, -39379526789629/19018526304540, ...
32727382324388/42900044865799, 41/200];
AE = [0, 0, 0, 0, 0, 0, 0, 0;
41/100, 0, 0, 0, 0, 0, 0, 0;
367902744464/2072280473677, 677623207551/8224143866563, 0, 0, 0, 0, 0, 0;
1268023523408/10340822734521, 0, 1029933939417/13636558850479, 0,0,0,0,0;
14463281900351/6315353703477, 0, 66114435211212/5879490589093, ...
-54053170152839/4284798021562, 0,0,0,0;
14090043504691/34967701212078, 0, 15191511035443/11219624916014, ...
-18461159152457/12425892160975, -281667163811/9011619295870, 0,0,0;
19230459214898/13134317526959, 0, 21275331358303/2942455364971, ...
-38145345988419/4862620318723, -1/8, -1/8, 0, 0;
-19977161125411/11928030595625, 0, -40795976796054/6384907823539, ...
177454434618887/12078138498510, 782672205425/8267701900261, ...
-69563011059811/9646580694205, 7356628210526/4942186776405, 0];
AI = [0, 0, 0, 0, 0, 0, 0, 0;
41/200, 41/200, 0, 0, 0, 0, 0, 0;
41/400, -567603406766/11931857230679, 41/200, 0, 0, 0, 0, 0;
683785636431/9252920307686, 0, -110385047103/1367015193373, 41/200, 0,0,0,0;
3016520224154/10081342136671, 0, 30586259806659/12414158314087, ...
-22760509404356/11113319521817, 41/200, 0, 0, 0;
218866479029/1489978393911, 0, 638256894668/5436446318841, ...
-1179710474555/5321154724896, -60928119172/8023461067671, 41/200, 0,0;
1020004230633/5715676835656, 0, 25762820946817/25263940353407, ...
-2161375909145/9755907335909, -211217309593/5846859502534, ...
-4269925059573/7827059040749, 41/200, 0;
-872700587467/9133579230613, 0, 0, 22348218063261/9555858737531, ...
-1143369518992/8141816002931, -39379526789629/19018526304540, ...
32727382324388/42900044865799, 41/200];
s = 8;
range = [0, 1];
h = [.1, .01, .001, .0001];
eps = [1, .1, .01, .001, .0001];
fprintf('ARK5\n');
k = 1;
fprintf('problem %d\n',k);
for i=1:length(eps)
    for j=1:length(h)
        [u, utrue, maxerr, t] = ARKERKDIRK(AE, AI, b, c, s, h(j), range, eps(i), k);
        fprintf('h = %e eps = %e maxerr = %e\n',h(j),eps(i),maxerr);
    end
end
eps = -eps;
for k = 2:4
    fprintf('problem %d\n',k);
    for i=1:length(eps)
        for j=1:length(h)
            [u, utrue, maxerr, t] = ARKERKDIRK(AE, AI, b, c, s, h(j), range, eps(i), k);
            fprintf('h = %e eps = %e maxerr = %e\n',h(j),eps(i),maxerr);
        end
    end
end
